## 环境变量

### 三种变量

在 Linux 中，变量依照作用域分为三种，分别是**环境变量**、**普通变量**、**导出变量**。

**环境变量**可以理解为 Windows 中的环境变量，在任一终端总可以直接访问到。

公共变量被存放在`/etc/profile`文件中，用户变量被存放在`~/.profile`中。

```shell
cat /etc/profile
```



**普通变量**仅在当前进程可用，在子进程中无法访问。

可以通过`declare {var}`声明变量或使用`{var}={value}`直接定义。通过`echo ${var}`查看变量。通过`unset {var}`释放变量。

```shell
declare temp
temp=333
echo $temp
unset temp
```



**导出变量**是临时环境变量，即临时导出到环境变量的普通变量。可以通过`export {var}`对普通变量进行导出，此时其子进程也可以访问该变量。

当前进程结束时，该导出变量一并销毁。

```shell
export temp
```

有三个命令可以查看变量：

```shell
set    # 显示所有变量
env    # 显示用户相关的环境变量
export # 显示导出变量
```



### 变量操作

#### 变量添加：

以`PATH`为例，将某路径添加到`PATH`环境变量中。

由于`PATH`变量以`:`作为分隔符，所以我们应该将`:{dir}`追加到`PATH`的末尾。

```shell
PATH=$PATH:/home/user/dir
```

字符串拼接不需要使用`+`，直接顺着写即可。

注意！！这种方式添加的环境变量是临时的，当关闭终端时失效。

想要让环境变量一直生效，可以让上述命令在终端初始化时执行，终端在初始化时会调用一个脚本，这里使用的是`zsh`，所以这个脚本位于用户主目录下`~/.zshrc`。

我们可以编辑他，将这条命令添加进去。

```shell
echo "PATH=$PATH:/home/user/dir" >> .zshrc
```

不过对于不同终端，这个初始化脚本也不同，例如`bash`的初始化脚本是`.bashrc`。

可以通过`cat /etc/shells`查看已安装的`Shell`

```shell
cat /etc/shells
```

#### 介绍一个命令`echo`：

```shell
echo {string}
```

`echo`可以将字符串输出到终端，如果要输出变量，那么变量名前应添加一个`$`。

`echo`还可以将输出定向至文件：

```shell
echo {string} > {filename}
```

```shell
echo {string} >> {filename}
```

`>`是直接覆盖文件，`>>`是追加到文件。

#### 变量修改

| 变量修改方式                   | 说明                                         |
| ------------------------------ | -------------------------------------------- |
| `${变量名#匹配字串}`           | 从头向后开始匹配，删除符合匹配字串的最短数据 |
| `${变量名##匹配字串}`          | 从头向后开始匹配，删除符合匹配字串的最长数据 |
| `${变量名%匹配字串}`           | 从尾向前开始匹配，删除符合匹配字串的最短数据 |
| `${变量名%%匹配字串}`          | 从尾向前开始匹配，删除符合匹配字串的最长数据 |
| `${变量名/旧的字串/新的字串}`  | 将符合旧字串的第一个字串替换为新的字串       |
| `${变量名//旧的字串/新的字串}` | 将符合旧字串的全部字串替换为新的字串         |

例如，我想将`PATH`变量中的`:/home/user/dir`删除：

```shell
PATH={PATH%%:/home/user/dir}
```

#### 执行初始化脚本

更改配置文件后，如果想要立即生效，就要重新执行一遍该脚本。

我们可以使用`source`命令：

```shell
source ./.zshrc
```

或者直接简写为：

```Shell	
. ./zshrc
```


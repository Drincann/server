# PHP 环境配置

## 安装 Apache 服务端

#### 下载 Apache :

在 Apache 官网下载 Apache 服务端 -> [http://httpd.apache.org/download.cgi](http://httpd.apache.org/download.cgi)



#### 修改配置 `/conf/httpd.conf`:

1. 修改`ServerRoot `为 Apache 服务端的根目录
2. 修改`DocumentRoot`为网站文件的根目录
3. 修改`Directory`为网站文件的根目录

> 通过 `./httpd.exe -t` 可以测试配置文件是否合法



#### 安装 Apache :

进入 Apache 根目录下的 `bin` 目录，以管理员权限运行`shell`，运行`httpd.exe`进行安装 : `> ./httpd.exe -k install`



#### 启动 Apache :

运行`httpd.exe` : `> ./httpd.exe -k start`



#### 开启虚拟主机 (反向代理) :

1. 虚拟主机的配置文件位于`/conf/extra/httpd-vhosts.conf`，但该功能默认关闭，需要在`/conf/httpd.conf`中开启 :

   将改行的注释取消即可

   > Include conf/extra/httpd-vhosts.conf

2. 编辑`/conf/extra/httpd-vhosts.conf`，配置虚拟主机

   一个虚拟主机的配置项大概是这样的 :
   
   ```config
   # 指定 ip:port
   <VirtualHost *:80>
   	# 网站目录
   	DocumentRoot "A:/Others/Apache/server"
   
   	# 主机名
   	ServerName "www.myFirstServer.com"
   
   	# 权限管理
   	<Directory "A:/Others/Apache/server">
   		Require all granted
   		# Require local 允许本地访问
   		# Require all granted 全部放通
   		# Require all Denied 全部拒绝
   		# Require ip *.*.*.* 允许指定 ip 访问
   		# Require not ip *.*.*.* 禁止指定 ip 访问
   		# Require host localhost 允许使用 localhost 访问
   
   		# 默认首页
   		
   		DirectoryIndex index.php index.html
   	</Directory>
   </VirtualHost>
   ```
   
   `ServerName`用于针对不同的访问域名进行请求分发。





## 安装 PHP

#### 下载 PHP : 

官网 -> [https://www.php.net/](https://www.php.net/)



#### 添加配置文件 :

在根目录下创建文件`php.ini`，将开发环境的配置文件模板`php.ini-development`内容 copy 到`php.ini`里。



#### 配置 Apache 的 PHP 解释器 :

1. 找到 PHP 根目录下关于 Apache 的动态链接库`php7apache2_4.dll`，打开 Apache 的配置文件`/conf/httpd.conf`，加载 PHP7 模块 :`LoadModule php7_module ${filename}`。
2. 将某些文件交给 PHP7 解释器处理 : 在`/conf/httpd.conf`里添加一行`AddType application/x-httpd-php .php`，后面还可以跟其他类型的文件，以空格作为分隔符。
3. 将 PHP7 的配置文件加载到 Apache： 在`/conf/httpd.conf`里添加一行`PHPIniDir ${filename}`。



#### 配置 PHP timezone

在 PHP7 根目录的`php.ini`中添加一句`timezone = PRC`，表示时区位于中国。



#### 查看 PHP 配置信息

在`.php`文件中调用`phpinfo`函数 :

```php
<?php
    phpinfo();
?>
```

然后通过 PHP 解释器进行解析，或开启服务器，通过服务端调用 php7 模块进行解析，可以看到 PHP 的配置信息。





## 安装 MySQL 数据库

#### 下载 MySql :

官网 -> [https://dev.mysql.com/downloads/mysql/](https://dev.mysql.com/downloads/mysql/)



#### 配置 MySQL :

在 MySQL 的根目录创建配置文件`mysql.ini`

>[mysqld]
>
>port = 3306
>
>basedir = A:/Others/MySql
>
>datadir = A:/Others/MySql/data
>
>max_connections = 200
>
>character-set-server = utf8
>
>default-storage-engine = INNODB
>
>sql_mode = NO_ENGINE_SUBSTITUTION, STRICT_TRANS_TABLES
>
>[mysql]
>
>character-set = utf8



#### 安装 MySQL :

1. 在`shell`中运行`mysqld.exe`，通过命令`mysqld.exe -install`进行安装

2. 初始化`mysqld.exe --initialize-insecure --user=mysql`

3. 启动服务`net start mysql`

4. 通过`mysqladmin.exe`程序进行用户的创建`mysqladmin -u ${username} -p ${oldPwd} password ${password}`

   例如`mysqladmin.exe -u root -p password root`

5. 现在可以通过`mysql.exe`程序与数据库进行交互`mysql.exe -u${username} -h${host} -P{port} -p${password}`，其中`-h`及`-P`默认是`localhost`和`3306`可以直接缺省。

